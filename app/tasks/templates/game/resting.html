{% extends "base.html" %}
{% load static %}
{% block content %}

{% if alert %}
<div class="alert-overlay" id="alert-overlay">
    <div class="alert-modal">
        <div class="alert-icon">âš ï¸</div>
        <div class="alert-message">{{ alert }}</div>
        <button class="alert-close-btn" onclick="document.getElementById('alert-overlay').style.display='none'">OK</button>
    </div>
</div>
{% endif %}

<div class="resting-page">
    
    {% if character.resting_start %}
    <!-- Tela quando jÃ¡ estÃ¡ descansando -->
    <div class="resting-active">
        <div class="resting-header">
            <h1 class="resting-title">VocÃª estÃ¡ Descansando</h1>
            <p class="resting-subtitle">Recuperando energias para as prÃ³ximas aventuras</p>
        </div>
        
        <!-- Cena de descanso minimalista -->
        <div class="resting-scene-minimal">
            <div class="scene-container">
                <div class="night-background">
                    <div class="moon-symbol">ğŸŒ™</div>
                    <div class="stars-symbol">âœ¨</div>
                </div>
                <div class="campfire-symbol">ğŸ”¥</div>
                <div class="character-symbol">ğŸ˜´</div>
                <div class="zzz-symbol">ğŸ’¤</div>
            </div>
        </div>
        
        <!-- Temporizador principal -->
        <div class="resting-timer">
            <div class="timer-icon">â³</div>
            <div class="timer-display" id="resting-timer">{{ time_elapsed.minutes }}m {{ time_elapsed.seconds }}s</div>
            <div class="timer-label">Tempo decorrido</div>
        </div>
        
        <!-- EstatÃ­sticas de regeneraÃ§Ã£o -->
        <div class="regen-stats">
            <div class="regen-stat">
                <div class="stat-icon">â¤ï¸</div>
                <div class="stat-content">
                    <div class="stat-value">{{ config.rest_hp_per_minute }}/min</div>
                    <div class="stat-label">Vida</div>
                </div>
            </div>
            
            <div class="regen-stat">
                <div class="stat-icon">ğŸŒ€</div>
                <div class="stat-content">
                    <div class="stat-value">{{ config.rest_mana_per_minute }}/min</div>
                    <div class="stat-label">Mana</div>
                </div>
            </div>
            
            <div class="regen-stat">
                <div class="stat-icon">ğŸ’ª</div>
                <div class="stat-content">
                    <div class="stat-value">{{ config.rest_stamina_per_minute }}/min</div>
                    <div class="stat-label">Stamina</div>
                </div>
            </div>
        </div>
        
        <!-- BotÃµes de aÃ§Ã£o -->
        <div class="resting-actions">
            <a href="{% url 'end_resting' %}" class="resting-btn resting-btn-danger">
                <span class="btn-icon">â›”</span>
                Encerrar Descanso
            </a>
        </div>
    </div>
    
    {% else %}
    <!-- Tela antes de iniciar -->
    <div class="resting-setup">
        <div class="resting-header">
            <h1 class="resting-title">ğŸ“‹ Descansar</h1>
            <p class="resting-subtitle">Recupere suas energias para os desafios que virÃ£o</p>
        </div>
        
        <!-- BenefÃ­cios do descanso -->
        <div class="resting-benefits">
            <div class="benefit-card">
                <div class="benefit-icon">â¤ï¸</div>
                <div class="benefit-content">
                    <h3 class="benefit-title">RegeneraÃ§Ã£o de Vida</h3>
                    <div class="benefit-value">{{ config.rest_hp_per_minute }}/min</div>
                    <div class="benefit-desc">Recupere pontos de vida para as prÃ³ximas batalhas</div>
                </div>
            </div>
            
            <div class="benefit-card">
                <div class="benefit-icon">ğŸŒ€</div>
                <div class="benefit-content">
                    <h3 class="benefit-title">RegeneraÃ§Ã£o de Mana</h3>
                    <div class="benefit-value">{{ config.rest_mana_per_minute }}/min</div>
                    <div class="benefit-desc">Recupere pontos de mana para conjurar mais habilidadews</div>
                </div>
            </div>
            
            <div class="benefit-card">
                <div class="benefit-icon">ğŸ’ª</div>
                <div class="benefit-content">
                    <h3 class="benefit-title">RegeneraÃ§Ã£o de Stamina</h3>
                    <div class="benefit-value">{{ config.rest_stamina_per_minute }}/min</div>
                    <div class="benefit-desc">Recupere energia para poder continuar suas aventuras</div>
                </div>
            </div>
        </div>
        
        <!-- Dicas -->
        <div class="resting-tips">
            <div class="tip-card">
                <div class="tip-icon">ğŸ’¡</div>
                <div class="tip-content">
                    <h3 class="tip-title">Dica de Descanso</h3>
                    <p class="tip-text">Descanse apÃ³s combates intensos para recuperar totalmente suas energias. O descanso Ã© essencial para aventuras longas.</p>
                </div>
            </div>
        </div>
        
        <!-- BotÃµes de aÃ§Ã£o -->
        <div class="resting-actions">
            <a href="{% url 'start_resting' %}" class="resting-btn resting-btn-primary">
                <span class="btn-icon">ğŸ˜´</span>
                ComeÃ§ar Descanso
            </a>
        </div>
    </div>
    {% endif %}
</div>

<script>
    {% if character.resting_start %}
    // Timer para descanso ativo
    let totalRestingSeconds = {{ time_elapsed.minutes }} * 60 + {{ time_elapsed.seconds }};
    
    function updateRestingTimer() {
        totalRestingSeconds++;
        let minutes = Math.floor(totalRestingSeconds / 60);
        let seconds = totalRestingSeconds % 60;
        document.getElementById('resting-timer').textContent = `${minutes}m ${seconds}s`;
    }
    
    setInterval(updateRestingTimer, 1000);
    {% endif %}
</script>

{% endblock %}