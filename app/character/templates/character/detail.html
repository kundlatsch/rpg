{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="attributes-page">
    <!-- Cabe√ßalho -->
    <div class="attributes-header-wrapper">
        <h1 class="attributes-main-title">{{ character.name }}</h1>
        <p class="attributes-subtitle">N√≠vel: {{ character.level }} - XP: {{ character.exp }}/{{ character.max_exp }}</p>
    </div>

    <div class="attributes-divider"></div>

    <!-- Pontos de Atributo -->
    {% if character.attribute_points != 0 %}
        <div class="attribute-points-section">
            <h2 class="attribute-points-title">Pontos de Atributo Dispon√≠veis</h2>
            <div class="attribute-points-display">
                <span class="attribute-points-value">{{ character.attribute_points }}</span>
            </div>
            <p class="attribute-points-text">Use os pontos ganhos ao subir de n√≠vel para melhorar seus atributos</p>
        </div>
    {% endif %}

    <div class="attributes-grid">
        <!-- Coluna da Esquerda - Atributos Prim√°rios -->
        <div class="attributes-column">
            <div class="attributes-section">
                <h2 class="attributes-section-title">Atributos Prim√°rios</h2>
                
                <div class="primary-attributes-list">
                    <!-- For√ßa -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">üí™</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">For√ßa</span>
                                <span class="primary-attribute-value">{{ character.strength }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="strength">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>

                    <!-- Destreza -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">üéØ</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">Destreza</span>
                                <span class="primary-attribute-value">{{ character.dexterity }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="dexterity">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>

                    <!-- Arcano -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">üîÆ</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">Arcano</span>
                                <span class="primary-attribute-value">{{ character.arcane }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="arcane">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>

                    <!-- Constitui√ß√£o -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">üõ°Ô∏è</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">Constitui√ß√£o</span>
                                <span class="primary-attribute-value">{{ character.constitution }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="constitution">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>

                    <!-- Coragem -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">‚ö°</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">Coragem</span>
                                <span class="primary-attribute-value">{{ character.courage }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="courage">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>

                    <!-- Sorte -->
                    <div class="primary-attribute-item">
                        <div class="primary-attribute-info">
                            <span class="primary-attribute-emoji">üçÄ</span>
                            <div class="primary-attribute-details">
                                <span class="primary-attribute-name">Sorte</span>
                                <span class="primary-attribute-value">{{ character.luck }}</span>
                            </div>
                        </div>
                        {% if character.attribute_points > 0 %}
                        <form method="POST" class="attribute-upgrade-form">
                            {% csrf_token %}
                            <input type="hidden" name="attribute" value="luck">
                            <button type="submit" class="attribute-upgrade-btn">+</button>
                        </form>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Coluna da Direita - Atributos Secund√°rios -->
        <div class="attributes-column">
            <div class="attributes-section">
                <h2 class="attributes-section-title">Atributos Secund√°rios</h2>
                
                <div class="secondary-attributes-grid">
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">‚öîÔ∏è</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Dano F√≠sico</span>
                            <span class="secondary-attribute-value">{{ character.physical_damage }}</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">‚ú®</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Dano M√°gico</span>
                            <span class="secondary-attribute-value">{{ character.magical_damage }}</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">üéØ</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Precis√£o</span>
                            <span class="secondary-attribute-value">{{ character.accuracy }}</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">üí•</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Chance de Cr√≠tico</span>
                            <span class="secondary-attribute-value">{{ character.crit_chance }}%</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">üî•</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Dano Cr√≠tico</span>
                            <span class="secondary-attribute-value">{{ character.crit_damage }}</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">‚ù§Ô∏è</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Vida Total</span>
                            <span class="secondary-attribute-value">{{ character.total_hp }}</span>
                        </div>
                    </div>
                    <div class="secondary-attribute-item">
                        <span class="secondary-attribute-emoji">üî∑</span>
                        <div class="secondary-attribute-details">
                            <span class="secondary-attribute-name">Mana Total</span>
                            <span class="secondary-attribute-value">{{ character.total_mana }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Per√≠cias -->
    <div class="professions-section">
        <h2 class="professions-section-title">Per√≠cias</h2>

        {% if professions %}
            <div class="professions-grid">
                {% for p in professions %}
                    <div class="profession-card" data-level="{{ p.level }}">
                        <div class="profession-header">
                            <span class="profession-emoji">{{ p.profession_type.emoji|default:"‚öíÔ∏è" }}</span>
                            <div class="profession-info">
                                <h4 class="profession-name">{{ p.profession_type.name }}</h4>
                            </div>
                        </div>
                        {% if p.profession_type.description %}
                        <div class="profession-description">
                            {{ p.profession_type.description }}
                        </div>
                        {% endif %}
                        
                        <div class="profession-level-container">
                            <div class="profession-level">
                                <span class="profession-level-badge">N√≠vel {{ p.level }}</span>
                            </div>
                        </div>

                        <div class="profession-progress">
                            <div class="profession-progress-info">
                                <span class="profession-xp-current">{{ p.exp }}</span>
                                <span class="profession-xp-separator">/</span>
                                <span class="profession-xp-max">{{ p.max_exp }} XP</span>
                            </div>
                            <div class="profession-progress-bar">
                                <div class="profession-progress-fill" style="width: {% widthratio p.exp p.max_exp 100 %}%"></div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-professions">
                <span class="no-professions-emoji">üîç</span>
                <p class="no-professions-text">Nenhuma profiss√£o aprendida ainda.</p>
            </div>
        {% endif %}
    </div>
</div>

<script>
// Character Attributes Page Animations
document.addEventListener('DOMContentLoaded', function() {

    // Anima√ß√£o para os atributos prim√°rios
    const primaryAttributes = document.querySelectorAll('.primary-attribute-item');
    primaryAttributes.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateX(-20px)';
        
        setTimeout(() => {
            item.style.transition = 'all 0.5s ease';
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, index * 80);
    });

    // Anima√ß√£o para os atributos secund√°rios
    const secondaryAttributes = document.querySelectorAll('.secondary-attribute-item');
    secondaryAttributes.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateX(20px)';
        
        setTimeout(() => {
            item.style.transition = 'all 0.5s ease';
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, 300 + (index * 60));
    });

    // Anima√ß√£o para os cards de profiss√£o
    const professionCards = document.querySelectorAll('.profession-card');
    professionCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.95)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.4s ease';
            card.style.opacity = '1';
            card.style.transform = 'scale(1)';
        }, 600 + (index * 100));
    });

    // Efeito de brilho para profiss√µes de n√≠vel alto
    professionCards.forEach(card => {
        const level = parseInt(card.getAttribute('data-level'));
        if (level >= 50) {
            setInterval(() => {
                card.style.borderColor = card.style.borderColor === 'rgba(255, 107, 107, 0.5)' ? 
                    'rgba(78, 205, 196, 0.5)' : 'rgba(255, 107, 107, 0.5)';
            }, 2000);
        }
    });

    // Efeito de hover para bot√µes de upgrade
    const upgradeButtons = document.querySelectorAll('.attribute-upgrade-btn');
    upgradeButtons.forEach(button => {
        button.addEventListener('mouseenter', function() {
            const attributeItem = this.closest('.primary-attribute-item');
            if (attributeItem) {
                attributeItem.style.transform = 'translateX(10px) scale(1.02)';
                attributeItem.style.boxShadow = '0 8px 20px rgba(0, 0, 0, 0.4)';
            }
        });
        
        button.addEventListener('mouseleave', function() {
            const attributeItem = this.closest('.primary-attribute-item');
            if (attributeItem) {
                attributeItem.style.transform = 'translateX(5px) scale(1)';
                attributeItem.style.boxShadow = 'none';
            }
        });
    });

    // Efeito de progresso nas barras de XP das profiss√µes
    const progressBars = document.querySelectorAll('.profession-progress-fill');
    progressBars.forEach(bar => {
        const width = bar.style.width;
        bar.style.width = '0';
        
        setTimeout(() => {
            bar.style.transition = 'width 1.5s ease-out';
            bar.style.width = width;
        }, 800);
    });


});
</script>
{% endblock %}