{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="ranking-page">
    <!-- Cabe√ßalho do ranking -->
    <div class="text-center mb-5">
        <h1 class="ranking-main-title">
            üèÜ Ranking dos Her√≥is
        </h1>
        <p class="ranking-subtitle">Os aventureiros mais poderosos do reino</p>
    </div>

    <!-- Container principal -->
    <div class="ranking-container">
        <!-- Tabela de ranking -->
        <div class="ranking-table-wrapper">
            <table class="ranking-table">
                <thead>
                    <tr>
                        <th class="ranking-table-header ranking-table-position">Posi√ß√£o</th>
                        <th class="ranking-table-header ranking-table-name">Her√≥i</th>
                        <th class="ranking-table-header ranking-table-level">N√≠vel</th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in page_obj %}
                    <tr class="ranking-table-row {% if c.id == character.id %}ranking-current-player{% endif %} {% if forloop.counter0|add:page_obj.start_index <= 3 %}ranking-top-three{% endif %}" 
                        data-position="{{ forloop.counter0|add:page_obj.start_index }}"
                        data-player-id="{{ c.id }}">
                        <td class="ranking-table-cell ranking-cell-position">
                            <div class="ranking-position-badge">
                                {% with position=forloop.counter0|add:page_obj.start_index %}
                                    {% if position == 1 %}
                                        <span class="ranking-position-crown">üëë</span>
                                    {% elif position == 2 %}
                                        <span class="ranking-position-medal">ü•à</span>
                                    {% elif position == 3 %}
                                        <span class="ranking-position-medal">ü•â</span>
                                    {% else %}
                                        <span class="ranking-position-number">#{{ position }}</span>
                                    {% endif %}
                                {% endwith %}
                            </div>
                        </td>
                        <td class="ranking-table-cell ranking-cell-name">
                            <div class="ranking-player-info">
                                <a href="{% url 'public_character' c.id %}" class="ranking-player-name">
                                    {{ c.name }}
                                </a>
                                {% if c.id == character.id %}
                                    <span class="ranking-player-you">(Voc√™)</span>
                                {% endif %}
                            </div>
                        </td>
                        <td class="ranking-table-cell ranking-cell-level">
                            <div class="ranking-level-display">
                                <span class="ranking-level-icon">‚≠ê</span>
                                <span class="ranking-level-value">{{ c.level }}</span>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pagina√ß√£o -->
        <div class="ranking-pagination">
            <nav class="ranking-pagination-nav">
                <div class="ranking-pagination-info">
                    P√°gina <strong>{{ page_obj.number }}</strong> de <strong>{{ page_obj.paginator.num_pages }}</strong>
                </div>
                <div class="ranking-pagination-controls">
                    {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}" class="ranking-pagination-btn ranking-pagination-prev">
                        <span class="ranking-pagination-arrow">‚Üê</span>
                        Anterior
                    </a>
                    {% else %}
                    <span class="ranking-pagination-btn ranking-pagination-prev ranking-pagination-disabled">
                        <span class="ranking-pagination-arrow">‚Üê</span>
                        Anterior
                    </span>
                    {% endif %}

                    {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}" class="ranking-pagination-btn ranking-pagination-next">
                        Pr√≥xima
                        <span class="ranking-pagination-arrow">‚Üí</span>
                    </a>
                    {% else %}
                    <span class="ranking-pagination-btn ranking-pagination-next ranking-pagination-disabled">
                        Pr√≥xima
                        <span class="ranking-pagination-arrow">‚Üí</span>
                    </span>
                    {% endif %}
                </div>
            </nav>
        </div>
    </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
    // Anima√ß√µes de entrada para as linhas
    const rows = document.querySelectorAll('.ranking-table-row');
    rows.forEach((row, index) => {
        row.style.opacity = '0';
        row.style.transform = 'translateX(-20px)';
        
        setTimeout(() => {
            row.style.transition = 'all 0.5s ease';
            row.style.opacity = '1';
            row.style.transform = 'translateX(0)';
        }, index * 50);
    });

    // Efeito de pulsa√ß√£o para o jogador atual
    {% comment %} const currentPlayer = document.querySelector('.ranking-current-player');
    if (currentPlayer) {
        let pulseInterval = setInterval(() => {
            currentPlayer.style.boxShadow = currentPlayer.style.boxShadow ? 
                '' : '0 0 20px rgba(255, 215, 0, 0.3)';
        }, 1000);

        // Pausar a anima√ß√£o quando o mouse estiver sobre o elemento
        currentPlayer.addEventListener('mouseenter', () => {
            clearInterval(pulseInterval);
            currentPlayer.style.boxShadow = '0 0 25px rgba(255, 215, 0, 0.4)';
        });

        currentPlayer.addEventListener('mouseleave', () => {
            clearInterval(pulseInterval);
            currentPlayer.style.boxShadow = '';
            pulseInterval = setInterval(() => {
                currentPlayer.style.boxShadow = currentPlayer.style.boxShadow ? 
                    '' : '0 0 20px rgba(255, 215, 0, 0.3)';
            }, 1000);
        });
    } {% endcomment %}

    // Efeito de hover para os links dos jogadores
    const playerLinks = document.querySelectorAll('.ranking-player-name');
    playerLinks.forEach(link => {
        link.addEventListener('mouseenter', function() {
            const row = this.closest('.ranking-table-row');
            if (row && !row.classList.contains('ranking-current-player')) {
                row.style.background = 'linear-gradient(90deg, rgba(255, 107, 107, 0.15), rgba(78, 205, 196, 0.15))';
            }
        });
        
        link.addEventListener('mouseleave', function() {
            const row = this.closest('.ranking-table-row');
            if (row && !row.classList.contains('ranking-current-player')) {
                row.style.background = '';
            }
        });
    });
});
</script>
{% endblock %}